config:
  # log_level: DEBUG
  output_dir: ./output/
  # show_graph: True
  # show_stacktrace: True

sources:
  scores:
    file: ./sources/scores.csv

transformations:
  grouped_scores:
    - operation: group_by
      source: $sources.scores
      group_by_columns:
        - group_id
      create_columns:
        num_scores: count()
        min_score: min(score)
        max_score: max(score)
        avg_score: mean(score)
        item_scores: agg(score,,)

destinations:
  grouped_score:
    source: $transformations.grouped_scores
    template: ./templates/aggregated_score.jsont
    extension: jsonl
    linearize: True